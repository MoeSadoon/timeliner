#!/usr/bin/env node

const args = require('minimist')(process.argv.slice(2));
const timeliner = require('../');

args.url = args.url || args._.slice(0, 2);
args.reporter = args.reporter || args.r;
args.count = args.count || args.c;

const reporter = args.reporter || 'table';

if (!timeliner.reporters[reporter]) {
  throw new Error(`Unrecognised reporter type "reporter"`);
}

if (args.help || !args.url) {
  require('./usage');
  process.exit();
}

timeliner(args)
  .then((output) => {
    const op = timeliner.reporters[reporter](output, args.url);
    if (reporter === 'fps') {
      op.forEach(o => { console.log(o); });
    } else {
      console.log(op);
    }
  });
